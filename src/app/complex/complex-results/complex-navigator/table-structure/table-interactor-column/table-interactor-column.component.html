<div class="Complex-navigator">
  <table class="interactors-table"
         [ngClass]="{'inheritedWidth': complexes().length > 6}"
         [style.--cols]="complexes().length">
    @for (interactor of enrichedInteractors; track i; let i = $index) {
      @if (!interactor.hidden) {
        <tr>
          @for (range of ranges; track range.value) {
            @if (range.start === i) {
              <td [attr.rowspan]="range.length" class="interactorSeparation"
                  [matTooltip]="interactorsSorting() === 'Organism' ? (range.value | species) : range.value">
                <div class="interactorNameContainer" [style.--rowspanSize]="range.length">
                  @if (interactorsSorting() === 'Organism') {
                    {{ range.value | species:true }}
                  } @else {
                    {{ range.value }}
                  }
                </div>
              </td>
            }
          }
          <td class="interactorsColumn"
              [ngClass]="complexes().length<=6 ? 'horizontalHeader' : 'interactorsColumnFixedWidth'"
              [style]="ranges.length!=0 ? 'left:3ch':''">
            <cp-table-interactor-name
              [interactorName]="interactor.interactor.name"
              [interactorType]="interactor.interactor.interactorType"
              [interactorId]="interactor.interactor.identifier"
              [interactorOrganism]="interactor.interactor.organismName"
              [identifierLink]="interactor.interactor.identifierLink"
              [organismIconDisplay]="organismIconDisplay()"
              [interactorTypeDisplay]="interactorTypeDisplay()"
              [idDisplay]="idDisplay()"
            ></cp-table-interactor-name>
            <!-- Icon for the expandable -->
            @if (interactor.isSubComplex) {
              <div class="container">
                <a (click)="toggleSubcomplexExpandable(i)"
                   [matTooltip]="interactor.interactor.name + ' components'">
                  Components
                  <i class="icon icon-common" data-icon="&#xf078;"
                     style="font-size:small;
                "></i>
                </a>
              </div>
            }
          </td>
          <!-- Interactors' stoichiometry -->
          @for (complex of enrichedComplexes; track complex.complex.complexAC) {
            <td class="intStoich"
                [style.--cols]="complexes().length"
                [ngClass]="{'intStoichFixedWidth': complexes().length > 6}"
                [class.predicted]="complex.complex.predictedComplex">
              <cp-table-main-interactor
                [complex]="complex"
                [i]="i"
                [enrichedInteractors]="enrichedInteractors"
              ></cp-table-main-interactor>
            </td>
          }
          @if (complexes().length > 6) {
            <div
              [ngClass]="isInteractorSortingSet() ? 'spaceHolderWithSorting' : 'spaceHolder'"></div>
          }
        </tr>
      }
      <!-- Expandable menu for subcomplexes -->
      @if (interactor.expanded) {
        @if (!!interactor.subComponents) {
          @for (el of interactor.subComponents; track el; let j = $index) {
            <tr
              class="expandedRows"
              [ngClass]="getExpandedRowClass(j, interactor.subComponents.length)">
              @if (j === 0 && (interactorsSorting() === 'Type' || interactorsSorting() === 'Organism')) {
                <td [attr.rowspan]="interactor.subComponents.length" class="interactorSeparation"
                    [matTooltip]="interactor.interactor.name + ' components'"
                >
                  <div class="interactorSeparationName"
                       [style.--rowspanSize]="interactor.subComponents.length"> {{ interactor.interactor.name }}
                    components
                  </div>
                </td>
              }
              <td class="subComponentColumn"
                  [ngClass]="complexes().length<=6 ? 'horizontalHeader' : 'interactorsColumnFixedWidth'"
                  [style]="ranges.length!=0 ? 'left:3ch':''">
                <div>
                  <cp-table-interactor-name
                    [interactorName]="el.name"
                    [interactorType]="el.interactorType"
                    [interactorId]="el.identifier"
                    [interactorOrganism]="interactor.interactor.organismName"
                    [identifierLink]="el.identifierLink"
                    [organismIconDisplay]="organismIconDisplay()"
                    [interactorTypeDisplay]="interactorTypeDisplay()"
                    [idDisplay]="idDisplay()"
                  ></cp-table-interactor-name>
                </div>
              </td>
              @for (complex of enrichedComplexes; track complex.complex.complexAC) {
                <td class="intStoich"
                    [style.--cols]="complexes().length"
                    [ngClass]="{'intStoichFixedWidth': complexes().length > 6}">
                  <cp-table-subcomponent-interactor
                    [complex]="complex"
                    [i]="i"
                    [j]="j"
                    [enrichedInteractors]="enrichedInteractors"
                  ></cp-table-subcomponent-interactor>
                </td>
              }
              @if (enrichedComplexes.length > 6) {
                <div class="spaceHolder"></div>
              }
            </tr>
          }
        }
      }
    }
  </table>
</div>
