<div class="Complex-navigator">
  <table class="interactors-table"
         [ngClass]="{'inheritedWidth': complexes().length > 6}">
    @for (interactor of navigatorComponents(); track i; let i = $index) {
      @if (!interactor.hidden) {
        <tr [class.ortholog]="!!interactor.isOrthologGroup && state.mergeOrthologs()">
          @for (range of ranges; track range.value) {
            @if (range.start === i) {
              <td [attr.rowspan]="range.length" class="sorting-side-panel"
                  [matTooltip]="isOrganismSorting() ? (range.value | species) : range.value">
                <div class="sorting-side-panel-name" [style.--rowspanSize]="range.length">
                  @if (isOrganismSorting()) {
                    {{ range.value | species:true }}
                  } @else {
                    {{ range.value }}
                  }
                </div>
              </td>
            }
          }
          <td class="components-column">
            <cp-table-interactor-name [interactor]="interactor"/>
            <!-- Icon for the expandable -->
            @if (interactor.hasSubComponents) {
              <div class="container">
                <a (click)="toggleSubcomplexExpandable(i)"
                   [matTooltip]="interactor.expandTooltip">
                  {{ interactor.expandLabel }}
                  <i class="icon icon-common" data-icon="&#xf078;"
                     style="font-size:small;
                "></i>
                </a>
              </div>
            }
            <div class="shadow right" [class.visible]="shadowVisible()"></div>
          </td>
          <!-- Interactors' stoichiometry -->
          @for (complex of navigatorComplexes; track complex.complex.complexAC) {
            <td class="stoichiometry-cell"
                [class.predicted]="complex.complex.predictedComplex">
              <cp-table-main-interactor
                [complex]="complex"
                [i]="i"
                [navigatorComponents]="navigatorComponents()"
              ></cp-table-main-interactor>
            </td>
          }
          @if (complexes().length > 6) {
            <div class="space-holder"></div>
          }
        </tr>
      }
      <!-- Expandable menu for subcomplexes -->
      @if (interactor.expanded) {
        @if (!!interactor.subComponents) {
          @for (subComponent of interactor.subComponents; track subComponent; let j = $index) {
            <tr
              class="expanded-row"
              [ngClass]="getExpandedRowClass(j, interactor.subComponents.length)">
              @if (j === 0 && state.isSorted()) {
                <td [attr.rowspan]="interactor.subComponents.length" class="interactorSeparation"
                    [matTooltip]="interactor.expandTooltip"
                >
                  <div class="sorting-side-panel-name"
                       [style.--rowspanSize]="interactor.subComponents.length"> {{ interactor.expandTooltip }}
                  </div>
                </td>
              }
              <td class="subcomponent-column" [style.left.px]="state.sortingWidth()">
                <div>
                  <cp-table-interactor-name [interactor]="subComponent"/>
                </div>
              </td>
              @for (complex of navigatorComplexes; track complex.complex.complexAC) {
                <td class="stoichiometry-cell"
                    [class.predicted]="complex.complex.predictedComplex">
                  <cp-table-subcomponent-interactor
                    [complex]="complex"
                    [i]="i"
                    [j]="j"
                    [navigatorComponents]="navigatorComponents()"/>
                </td>
              }
              @if (navigatorComplexes.length > 6) {
                <div class="space-holder"></div>
              }
            </tr>
          }
        }
      }
    }
  </table>
</div>
