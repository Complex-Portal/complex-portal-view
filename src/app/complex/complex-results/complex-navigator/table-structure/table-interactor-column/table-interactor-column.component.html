<div class="Complex-navigator">
  <table class="interactors-table"
         [ngClass]="{'inheritedWidth': complexes().length > 6}"
         [style.--cols]="complexes().length">
    @for (interactor of navigatorComponents(); track i; let i = $index) {
      @if (!interactor.hidden) {
        <tr
          [class.ortholog]="!!interactor.isOrthologGroup && componentsGrouping() === NavigatorComponentGrouping.ORTHOLOGY">
          @for (range of ranges; track range.value) {
            @if (range.start === i) {
              <td [attr.rowspan]="range.length" class="interactorSeparation"
                  [matTooltip]="componentsSorting() === NavigatorComponentSorting.ORGANISM ? (range.value | species) : range.value">
                <div class="interactorNameContainer" [style.--rowspanSize]="range.length">
                  @if (componentsSorting() === NavigatorComponentSorting.ORGANISM) {
                    {{ range.value | species:true }}
                  } @else {
                    {{ range.value }}
                  }
                </div>
              </td>
            }
          }
          <td class="interactorsColumn"
              [ngClass]="complexes().length<=6 ? 'horizontalHeader' : 'interactorsColumnFixedWidth'"
              [style]="ranges.length!=0 ? 'left:3ch':''">
            <cp-table-interactor-name
              [interactorName]="interactor.name"
              [interactorType]="interactor.interactorType"
              [interactorId]="interactor.identifier"
              [interactorOrganism]="interactor.organismName"
              [identifierLink]="interactor.identifierLink"
              [organismIconDisplay]="organismIconDisplay()"
              [interactorTypeDisplay]="interactorTypeDisplay()"
              [idDisplay]="idDisplay()"
              [isOrtholog]="interactor.isOrthologGroup && componentsGrouping() === NavigatorComponentGrouping.ORTHOLOGY">
            </cp-table-interactor-name>
            <!-- Icon for the expandable -->
            @if (interactor.hasSubComponents) {
              <div class="container">
                <a (click)="toggleSubcomplexExpandable(i)"
                   [matTooltip]="interactor.expandTooltip">
                  {{ interactor.expandLabel }}
                  <i class="icon icon-common" data-icon="&#xf078;"
                     style="font-size:small;
                "></i>
                </a>
              </div>
            }
          </td>
          <!-- Interactors' stoichiometry -->
          @for (complex of navigatorComplexes; track complex.complex.complexAC) {
            <td class="intStoich" [ngClass]="{'intStoichFixedWidth': complexes().length > 6}"
                [class.predicted]="complex.complex.predictedComplex">
              <cp-table-main-interactor
                [complex]="complex"
                [i]="i"
                [navigatorComponents]="navigatorComponents()"
              ></cp-table-main-interactor>
            </td>
          }
          @if (complexes().length > 6) {
            <div
              [ngClass]="isComponentsSortingSet() ? 'spaceHolderWithSorting' : 'spaceHolder'"></div>
          }
        </tr>
      }
      <!-- Expandable menu for subcomplexes -->
      @if (interactor.expanded) {
        @if (!!interactor.subComponents) {
          @for (subComponent of interactor.subComponents; track subComponent; let j = $index) {
            <tr
              class="expandedRows"
              [ngClass]="getExpandedRowClass(j, interactor.subComponents.length)">
              @if (j === 0 && isComponentsSortingSet()) {
                <td [attr.rowspan]="interactor.subComponents.length" class="interactorSeparation"
                    [matTooltip]="interactor.expandTooltip"
                >
                  <div class="interactorSeparationName"
                       [style.--rowspanSize]="interactor.subComponents.length"> {{ interactor.expandTooltip }}
                  </div>
                </td>
              }
              <td class="subComponentColumn"
                  [ngClass]="complexes().length<=6 ? 'horizontalHeader' : 'interactorsColumnFixedWidth'"
                  [style]="ranges.length!=0 ? 'left:3ch':''">
                <div>
                  <cp-table-interactor-name
                    [interactorName]="subComponent.name"
                    [interactorType]="subComponent.interactorType"
                    [interactorId]="subComponent.identifier"
                    [interactorOrganism]="subComponent.organismName"
                    [identifierLink]="subComponent.identifierLink"
                    [organismIconDisplay]="organismIconDisplay()"
                    [interactorTypeDisplay]="interactorTypeDisplay()"
                    [idDisplay]="idDisplay()"
                  ></cp-table-interactor-name>
                </div>
              </td>
              @for (complex of navigatorComplexes; track complex.complex.complexAC) {
                <td class="intStoich" [ngClass]="{'intStoichFixedWidth': complexes().length > 6}"
                    [class.predicted]="complex.complex.predictedComplex">
                  <cp-table-subcomponent-interactor
                    [complex]="complex"
                    [i]="i"
                    [j]="j"
                    [navigatorComponents]="navigatorComponents()"
                  ></cp-table-subcomponent-interactor>
                </td>
              }
              @if (navigatorComplexes.length > 6) {
                <div class="spaceHolder"></div>
              }
            </tr>
          }
        }
      }
    }
  </table>
</div>
